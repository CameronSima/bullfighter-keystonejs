extends ../layouts/default

mixin trade(trade)
	.post(data-ks-editable=editable(user, { list: 'Trade', id: trade.id }))
		h2: a(href='/trades/trade/' + trade.slug)= trade.title
		p.lead.text-muted Posted 
			if trade.publishedDate
				| on #{trade._.publishedDate.format('MMMM Do, YYYY')} 
			if trade.author
				| by #{trade.author.name.first}
			if trade.image.exists
				img(src=trade.image.fit(160, 160)).img.pull-right
		table.table 
			thead
				tr
					th Direction 
						a(href='/trades/sorted/direction/asc')
							span.glyphicon.glyphicon-triangle-top
						a(href='/trades/sorted/direction/desc')
							span.glyphicon.glyphicon-triangle-bottom
					th Symbol 
						a(href='/trades/sorted/symbol/asc')
							span.glyphicon.glyphicon-triangle-top
						a(href='/trades/sorted/symbol/desc')
							span.glyphicon.glyphicon-triangle-bottom
					th Bought Date 
						a(href='/trades/sorted/boughtDate/asc')
							span.glyphicon.glyphicon-triangle-top
						a(href='/trades/sorted/boughtDate/desc')
							span.glyphicon.glyphicon-triangle-bottom
					th Bought Price 
						a(href='/trades/sorted/boughtPrice/asc')
							span.glyphicon.glyphicon-triangle-top
						a(href='/trades/sorted/boughtPrice/desc')
							span.glyphicon.glyphicon-triangle-bottom
					th Sold Date 
						a(href='/trades/sorted/soldDate/asc')
							span.glyphicon.glyphicon-triangle-top
						a(href='/trades/sorted/soldDate/desc')
							span.glyphicon.glyphicon-triangle-bottom
					th Sold Price 
						a(href='/trades/sorted/soldPrice/asc')
							span.glyphicon.glyphicon-triangle-top
						a(href='/trades/sorted/soldPrice/desc')
							span.glyphicon.glyphicon-triangle-bottom
					th Percent Change
						a(href='/trades/sorted/percentChange/asc')
							span.glyphicon.glyphicon-triangle-top
						a(href='/trades/sorted/percentChange/desc')
							span.glyphicon.glyphicon-triangle-bottom
			tbody
				tr
					td #{trade.content.direction}
					td #{trade.content.symbol}
					td #{trade._.content.boughtDate.format('MM/DD/YYYY')}
					td #{trade._.content.boughtPrice.format()}
					td #{trade._.content.soldDate.format('MM/DD/YYYY')}
					td #{trade._.content.soldPrice.format()}
					td #{trade.content.percentChange}%
			p.read-more: a(href='/trades/trade/' + trade.slug) Read More...


block intro
	.container
		h1= 'Trades'

block content
	.container: .row
		.col-sm-8.col-md-9
			if data.trades.results.length
				if data.trades.totalPages > 1
					h4.text-weight-normal Showing
						strong #{data.trades.first}
						| to
						strong #{data.trades.total}
						| trades.
				else
					h4.text-weight-normal Showing #{utils.plural(data.trades.results.length, '* trade')}.
				.blog
					each trade in data.trades.results
						+trade(trade)

				if data.trades.totalPages > 1
					ul.pagination
						if data.trades.previous
							li: a(href='?page=' + data.trades.previous): span.glyphicon.gliphicon-chevrom-left
						else
							li.disabled: a(href='?page=' + 1): span.glyphicon.glyphicon-chevron-left
						each p, i in data.trades.pages
							li(class=data.trades.currentPage == p ? 'active' : null)
								a(href='?page=' + (p == '...' ? (i ? data.trades.totalPages : 1) : p ))= p
						if data.trades.next
							li: a(href='?page=' + data.trades.next): span.glyphicon.gliphicon-chevron-right
						else
							li.disabled: a(href='?page=' data.trades.totalPages): span.entypo.glyphicon.glyphicon-chevron-right
			else
				h3.text-muted There are no trades yet.
